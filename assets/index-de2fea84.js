var N=Object.defineProperty;var f=(e,t,n)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var s=(e,t,n)=>(f(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const a of u)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function n(u){const a={};return u.integrity&&(a.integrity=u.integrity),u.referrerpolicy&&(a.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?a.credentials="include":u.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(u){if(u.ep)return;u.ep=!0;const a=n(u);fetch(u.href,a)}})();var i=(e=>(e.MULTIPLY="*",e.DIVIDE="\xF7",e.PLUS="+",e.MINUS="-",e.ROOT="\u221A",e.POWER="^",e))(i||{}),d=(e=>(e.COMMA=",",e.PERCENT="%",e.EQUALS="=",e.ENTER="Enter",e.DELETE="Backspace",e))(d||{}),h=(e=>(e.LEFT="(",e.RIGHT=")",e))(h||{}),r=(e=>(e.NUMBER="number",e.OPERATION="operation",e.BRACKET="bracket",e.EQUALS="equals",e))(r||{}),m=(e=>(e.NUMBER_BUTTON="numberButton",e.OPERATION_BUTTON="operationButton",e.DELETE_BUTTON="deleteButton",e.ALL_CLEAR_BUTTON="allClearButton",e.EQUALS_BUTTON="equalsButton",e.PERCENT_BUTTON="percentButton",e.COMMA_BUTTON="commaButton",e.EXPAND_BUTTON="expandButton",e.BRACKET_BUTTON="bracketButton",e))(m||{}),g=(e=>(e.ZERO="0",e.ONE="1",e.TWO="2",e.THREE="3",e.FOUR="4",e.FIVE="5",e.SIX="6",e.SEVEN="7",e.EIGHT="8",e.NINE="9",e))(g||{});function S(e,t,n,o){n.forEach((u,a)=>{u.addEventListener("click",()=>{switch(o[a].type){case m.EXPAND_BUTTON:t.expandKeyboard();break;case m.ALL_CLEAR_BUTTON:e.clear();break;case m.DELETE_BUTTON:e.deleteLast();break;case m.EQUALS_BUTTON:e.compute();break;case m.COMMA_BUTTON:e.appendComma();break;case m.PERCENT_BUTTON:e.changeLastOperandToPercent();break;case m.NUMBER_BUTTON:{u.textContent!==null&&e.appendNumber(u.textContent);break}case m.OPERATION_BUTTON:{u.textContent!==null&&Object.values(i).includes(u.textContent)&&e.appendOperation(u.textContent);break}case m.BRACKET_BUTTON:{u.textContent!==null&&e.appendBracket(u.textContent);break}}o[a].type!==m.EXPAND_BUTTON&&t.updateScreen(e.getPreviousComputeSequenceArray(),e.getComputeSequenceArray(),e.getComputed())})})}function B(e,t){document.addEventListener("keydown",n=>{const o={numbers:Object.values(g),operations:Object.values(i),brackets:Object.values(h),equals:[d.EQUALS,d.ENTER],comma:d.COMMA,percent:d.PERCENT,delete:d.DELETE};o.numbers.includes(n.key)?e.appendNumber(n.key):o.operations.includes(n.key)&&Object.values(i).includes(n.key)?e.appendOperation(n.key):o.equals.includes(n.key)?e.compute():o.brackets.includes(n.key)?e.appendBracket(n.key):n.key===o.comma?e.appendComma():n.key===o.delete?e.deleteLast():n.key===o.percent&&e.changeLastOperandToPercent(),t.updateScreen(e.getPreviousComputeSequenceArray(),e.getComputeSequenceArray(),e.getComputed())})}function x(e){const t=e.filter(o=>o.value===h.LEFT),n=e.filter(o=>o.value===h.RIGHT);return t.length===n.length}function C(e,t,n){switch(e){case i.PLUS:return parseFloat((t+n).toFixed(10));case i.MINUS:return parseFloat((t-n).toFixed(10));case i.MULTIPLY:return parseFloat((t*n).toFixed(10));case i.DIVIDE:return n!==0?parseFloat((t/n).toFixed(10)):null;case i.POWER:{let o=t;for(let u=1;u<=n-1;u+=1)o*=t;return o}default:return null}}function v(e){const t=[i.POWER,i.MULTIPLY,i.DIVIDE,i.MINUS,i.PLUS],n=[...e];return t.forEach(o=>{for(;n.find(u=>u.value===o)!=null;)n.forEach((u,a)=>{if(u.value===o){const p=n[a-1],l=n[a+1],c=C(u.value,parseFloat(p.value),parseFloat(l.value));c!=null&&n.splice(a-1,3,{type:r.NUMBER,value:c.toString()})}})}),n[0]}function O(e,t,n){var a,p,l;const o=[...e],u=(a=t==null?void 0:t.find(c=>c>n))!=null?a:null;if(u!==null){const c=o.filter((L,E)=>E>n&&E<u),y=c.length!==1?v(c):{type:"number",value:c[0].value};o[n-2].type===r.NUMBER?(o[n-1].type!==r.OPERATION&&o.splice(n-1,0,{type:r.OPERATION,value:i.MULTIPLY}),o.splice(n+1,u,y)):o.splice(n-1,u,y),(((p=o[n-1])==null?void 0:p.value)===i.ROOT||((l=o[n-1])==null?void 0:l.value)===i.POWER)&&o.splice(n,1)}return o}function b(e,t=null,n=null,o=null){const u=document.createElement(e);return t&&(u.className=t),n&&(u.id=n),o&&(u.innerText=o),u}class q{constructor(){s(this,"previousComputeSequenceArray",Array());s(this,"computeSequenceArray",Array());s(this,"computed",null)}getPreviousComputeSequenceArray(){return this.previousComputeSequenceArray}getComputeSequenceArray(){return this.computeSequenceArray}getComputed(){return this.computed}appendNumber(t){const n=this.computeSequenceArray[this.computeSequenceArray.length-1];(n==null?void 0:n.value.length)>19||(n==null||n.type===r.OPERATION||n.type===r.BRACKET?this.computeSequenceArray.push({type:r.NUMBER,value:t}):(n.type===r.NUMBER||this.computeSequenceArray.length===1&&n.value===i.MINUS)&&(n.type=r.NUMBER,n.value+=t))}appendOperation(t){this.computed!==null&&this.previousComputeSequenceArray.push({type:r.EQUALS,value:d.EQUALS},{type:r.NUMBER,value:this.computed.toString()});const n=this.computeSequenceArray[this.computeSequenceArray.length-1];this.computed=null,(n==null?void 0:n.type)===r.OPERATION?n.value=t:this.computeSequenceArray.push({type:r.OPERATION,value:t}),(t===i.ROOT||t===i.POWER)&&this.computeSequenceArray.push({type:r.BRACKET,value:h.LEFT})}appendBracket(t){this.computeSequenceArray.push({type:r.BRACKET,value:t})}appendComma(){const t=this.computeSequenceArray[this.computeSequenceArray.length-1];(t==null?void 0:t.type)===r.NUMBER&&(t==null?void 0:t.value.charAt(t.value.length-1))!=="."&&(t.value+=".")}changeLastOperandToPercent(){const t=this.computeSequenceArray[this.computeSequenceArray.length-1],n=this.computeSequenceArray[this.computeSequenceArray.length-3];(t==null?void 0:t.type)===r.NUMBER&&n!=null&&(t.value=(parseFloat(n.value)*parseFloat(t.value)/100).toString())}clear(){this.computeSequenceArray.length===0?this.previousComputeSequenceArray=[]:this.computed!=null&&this.previousComputeSequenceArray.push({type:r.EQUALS,value:d.EQUALS},{type:r.NUMBER,value:this.computed.toString()}),this.computeSequenceArray=[],this.computed=null}deleteLast(){if(this.computed!==null&&(this.previousComputeSequenceArray.push({type:r.EQUALS,value:d.EQUALS},{type:r.NUMBER,value:this.computed.toString()}),this.computed=null),this.computeSequenceArray.length===0)this.previousComputeSequenceArray=[];else{const t=this.computeSequenceArray.length-1,n=this.computeSequenceArray[t].value;this.computeSequenceArray[t].value=n.slice(0,-1),this.computeSequenceArray[t].value===""&&this.computeSequenceArray.pop()}}compute(){var t,n;if(this.computed!==null&&this.moveComputedToPreviousSequence(this.computed.toString()),this.computeSequenceArray.length!==0){let o=[];if(this.previousComputeSequenceArray=[...this.computeSequenceArray],!x(this.computeSequenceArray))this.computeSequenceArray=[{type:"exception",value:"Brackets are not closed"}];else{const u=(t=this.computeSequenceArray.map((l,c)=>l.value===h.LEFT?c:null))==null?void 0:t.filter(l=>l!==null),a=(n=this.computeSequenceArray.map((l,c)=>l.value===h.RIGHT?c:null))==null?void 0:n.filter(l=>l!==null);u==null||u.reverse().forEach(l=>{o=O(this.computeSequenceArray,a,l)});const p=v(o.length!==0?o:this.computeSequenceArray);this.computed=parseFloat(p.value),this.computeSequenceArray=[p]}}}moveComputedToPreviousSequence(t){this.previousComputeSequenceArray.push({type:r.EQUALS,value:d.EQUALS},{type:r.NUMBER,value:t}),this.computeSequenceArray=[],this.computed=null}}class U{constructor(t,n){s(this,"root");s(this,"calculatorElement");s(this,"previousOperationTextElement");s(this,"currentOperationTextElement");s(this,"infoTextElement");s(this,"screenElement");s(this,"keyboardElement");s(this,"buttonsJson");s(this,"buttonElements",[]);s(this,"buttonsToExpand",[]);this.root=t,this.calculatorElement=b("div","calculator"),this.screenElement=b("div","screen","screen"),this.previousOperationTextElement=b("div","screen__previous","previousText"),this.currentOperationTextElement=b("div","screen__current","currentText"),this.infoTextElement=b("div","screen__info","infoText"),this.keyboardElement=b("div","keyboard","keyboard"),this.buttonsJson=n}getButtonElements(){return this.buttonElements}getButtonsToExpand(){return this.buttonsToExpand}updateScreen(t,n,o){this.previousOperationTextElement.innerText=t.map(u=>u.value).join(""),this.currentOperationTextElement.innerText=n.map(u=>u.value).join(""),o!=null&&(this.previousOperationTextElement.innerText=t.map(u=>u.value).join(""),this.currentOperationTextElement.innerText=`=${o}`),this.currentOperationTextElement.scrollWidth>this.screenElement.scrollWidth&&(this.currentOperationTextElement.style.fontSize="2rem")}expandKeyboard(){var t;(t=this.buttonsToExpand)==null||t.forEach(n=>{n.style.display==="block"?n.style.display="none":n.style.display="block"})}buildUI(){this.root.appendChild(this.calculatorElement),this.calculatorElement.appendChild(this.screenElement),this.calculatorElement.appendChild(this.keyboardElement),this.screenElement.appendChild(this.previousOperationTextElement),this.screenElement.appendChild(this.currentOperationTextElement),this.screenElement.appendChild(this.infoTextElement),this.buttonsJson.forEach(t=>{const n=b(t.tagName,t.class,t.id,t.innerText);this.keyboardElement.appendChild(n),this.buttonElements.push(n),t.class.includes("button--expanded")&&this.buttonsToExpand.push(n)})}}const T=[{type:"bracketButton",tagName:"button",class:"button button--orange button--expanded bracketButton",id:null,innerText:"("},{type:"bracketButton",tagName:"button",class:"button button--orange button--expanded bracketButton",id:null,innerText:")"},{type:"operationButton",tagName:"button",class:"button button--orange operation button--expanded",id:null,innerText:"\u221A"},{type:"operationButton",tagName:"button",class:"button button--orange operation button--expanded",id:null,innerText:"^"},{type:"allClearButton",tagName:"button",class:"button button--muted button--portrait allClearButton",id:null,innerText:"AC"},{type:"deleteButton",tagName:"button",class:"button button--muted  button--portrait deleteButton",id:null,innerText:"D"},{type:"percentButton",tagName:"button",class:"button button--orange button--portrait percentButton",id:null,innerText:"%"},{type:"operationButton",tagName:"button",class:"button button--orange operation  button--portrait",id:null,innerText:"\xF7"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"7"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"8"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"9"},{type:"operationButton",tagName:"button",class:"button button--orange operation",id:null,innerText:"*"},{type:"bracketButton",tagName:"button",class:"button button--orange button--landscape bracketButton",id:null,innerText:"("},{type:"allClearButton",tagName:"button",class:"button button--muted button--landscape allClearButton",id:null,innerText:"AC"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"4"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"5"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"6"},{type:"operationButton",tagName:"button",class:"button button--orange operation",id:null,innerText:"-"},{type:"bracketButton",tagName:"button",class:"button button--orange button--landscape bracketButton",id:null,innerText:")"},{type:"deleteButton",tagName:"button",class:"button button--muted button--landscape deleteButton",id:null,innerText:"D"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"1"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"2"},{type:"numberButton",tagName:"button",class:"button number",id:null,innerText:"3"},{type:"operationButton",tagName:"button",class:"button button--orange operation",id:null,innerText:"+"},{type:"operationButton",tagName:"button",class:"button button--orange button--landscape operation",id:null,innerText:"\u221A"},{type:"percentButton",tagName:"button",class:"button button--orange button--landscape percentButton",id:null,innerText:"%"},{type:"expandButton",tagName:"button",class:"button button--pressed-in button--portrait",id:"expandKeyboardButton",innerText:"\u21D4"},{type:"numberButton",tagName:"button",class:"button button--wide-on-landscape button--pressed-in-on-landscape number",id:null,innerText:"0"},{type:"commaButton",tagName:"button",class:"button",id:"commaButton",innerText:"."},{type:"operationButton",tagName:"button",class:"button button--orange operation  button--landscape",id:null,innerText:"\xF7"},{type:"operationButton",tagName:"button",class:"button button--orange button--landscape operation",id:null,innerText:"^"},{type:"equalsButton",tagName:"button",class:"button button--orange",id:"equalsButton",innerText:"="}];const A=document.getElementById("root");if(A!==null){const e=new q,t=new U(A,T);t.buildUI(),S(e,t,t.getButtonElements(),T),B(e,t)}
